# Разработка модели машинного обучения для отбора коров «ЭкоФермы» в поголовье молочного хозяйства «Вольный луг»

Вы работаете в IT-компании, которая выполняет на заказ проекты по машинному обучению. К вам обратился фермер, владелец молочного хозяйства «Вольный луг». Он хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ «ЭкоФерма».

Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным - строго по его критериям, ничуть не хуже. А продавцы и технологи так и норовят приукрасить своих коровок!

Поэтому он просит вас разработать модель машинного обучения, которая поможет ему управлять рисками и принимать объективное решение о покупке. «ЭкоФерма» готова предоставить подробные данные о своих коровах.

Вам нужно создать две прогнозные модели для отбора бурёнок в поголовье:

1. первая будет прогнозировать возможный удой коровы (целевой признак 'Удой')
2. вторая - рассчитывать вероятность получить вкусное молоко от коровы (целевой признак 'Вкус молока')

С помощью модели нужно отобрать коров по двум критериям:
1. средний удой за год - не менее 6000 килограммов
2. молоко должно быть вкусным

## Задачи исследования

* провести предобработку и анализ данных
* обучить несколько моделей линейной регрессии
* выбрать лучшую модель линейной регрессии, с помощью которой спрогнозировать удой
* обучить модель логистической регрессии и подобрать для нее оптимальное пороговое значение
* с помощью модели логистической регрессии спрогнозировать вкус молока коров
* сделать выводы, дать рекомендации

## Цели исследования

* создать две прогнозные модели для отбора бурёнок в поголовье:  
1. первая будет прогнозировать возможный удой коровы (целевой признак 'удой')  
2. вторая - рассчитывать вероятность получить вкусное молоко от коровы (целевой признак 'вкус молока')

* с помощью модели отобрать коров по двум критериям:  
1. средний удой за год — не менее 6000 килограммов  
2. молоко должно быть вкусным

## Данные для анализа

ferma_main.csv - датасет с данными о стаде фермера на текущий момент (предоставил владелец молочного хозяйства «Вольный луг»)
ferma_dad.csv - датасет с именем папы каждой коровы в стаде фермера (предоставил владелец молочного хозяйства «Вольный луг») 
cow_buy.csv - датасет с данными о коровах «ЭкоФермы» (данные предоставлены ассоциацией пастбищ «ЭкоФерма»)

## Описание данных

Датасет ferma_main.csv:

* *id* — уникальный идентификатор коровы
* *Удой, кг* — масса молока, которую корова даёт в год (в килограммах)
* *ЭКЕ (Энергетическая кормовая единица)* — показатель питательности корма коровы
* *Сырой протеин, г* — содержание сырого протеина в корме (в граммах)
* *СПО (Сахаро-протеиновое соотношение)* — отношение сахара к протеину в корме коровы
* *Порода* — порода коровы
* *Тип пастбища* — ландшафт лугов, на которых паслась корова
* *порода папы_быка* — порода папы коровы
* *Жирность,%* — содержание жиров в молоке (в процентах)
* *Белок,%* — содержание белков в молоке (в процентах)
* *Вкус молока* — оценка вкуса по личным критериям фермера, бинарный признак (вкусно, не вкусно)
* *Возраст* — возраст коровы, бинарный признак (менее_2_лет, более_2_лет)

Признаки в датасете ferma_main.csv можно разделить на группы (важно для понимания взаимосвязей признаков в датасете):

*Характеристики коровы*: id, Порода, порода папы_быка, Возраст  
*Характеристики корма*: ЭКЕ (Энергетическая кормовая единица), Сырой протеин, г, СПО (Сахаро-протеиновое соотношение)  
*Характеристика пастбища*: Тип пастбища  
*Характеристики молока*: Удой, кг, Жирность,%, Белок,%, Вкус молока  

Датасет ferma_dad.csv:
* *id* — уникальный идентификатор коровы
* *Имя Папы* — имя папы коровы

Датасет ferma_cow_buy.csv:

* *Порода* — порода коровы
* *Тип пастбища* — ландшафт лугов, на которых паслась корова
* *порода папы_быка* — порода папы коровы
* *Имя_папы* — имя папы коровы
* *Текущая_жирность,%* — содержание жиров в молоке (в процентах)
* *Текущий_уровень_белок,%* — содержание белков в молоке (в процентах)
* *Возраст* — возраст коровы, бинарный признак (менее 2 лет, более 2 лет)

Данные в файлах ferma_main.csv и cow_buy.csv похожи, но у датасета cow_buy.csv несколько особенностей:

Содержание белков и жиров в молоке указано на момент продажи - когда «ЭкоФерма» давала коровам свой корм  
Параметры корма ЭКЕ (Энергетическая кормовая единица), Сырой протеин, г и СПО (Сахаро-протеиновое соотношение) отсутствуют  
Технологи заказчика пересмотрели подход к кормлению: для новых коров планируется увеличить значения каждого из этих параметров на 5%.  
Кроме того, отсутствуют признаки Удой, кг и Вкус молока (это целевые признаки, которые предстоит предсказать)

## Этапы работы над проектом

*Шаг 1.* Загрузка данных

*Шаг 2.* Предобработка данных:  
работа с наименованиями столбцов  
работа с дубликатами

*Шаг 3.* Исследовательский анализ данных  
анализ признаков датасета herd  
анализ признаков датасета dad_name  
анализ признаков датасета cows  
вывод по результам исследовательского анализа

*Шаг 4.* Корреляционный анализ признаков в датасете herd  
анализ взаимосвязи между признаками с помощью матрицы корреляции  
построения диаграмм рассеяния для целевого / всех количественных признаков  
вывод по результам корреляционного анализа

*Шаг 5.* Обучение модели линейной регрессии  
обучение трех разных моделей линейной регрессии  
сравнение качества моделей (R2, остатки)  
сравнение качества моделей (MSE, MAE, RMSE)  
прогноз целевого показателя (удой)

*Шаг 6.* Обучение модели логистической регрессии  
обучение модели логистической регрессии  
анализ модели логистической регрессии  
подбор оптимального порога принадлежности к классам  
прогноз целевого показателя (вкус молока)

*Шаг 7.* Итоговые выводы  
результаты исследования, рекомендации
